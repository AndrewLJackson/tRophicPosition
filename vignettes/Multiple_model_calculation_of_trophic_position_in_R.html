<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Claudio Quezada-Romegialli, Andrew L Jackson &amp; Chris Harrod" />


<title>Using tRophicPosition to estimate TP through the use of multiple models</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Using tRophicPosition to estimate TP through the use of multiple models</h1>
<h4 class="author"><em>Claudio Quezada-Romegialli, Andrew L Jackson &amp; Chris Harrod</em></h4>
<h4 class="date"><em>May 23 2017</em></h4>



<div id="trophicposition" class="section level1">
<h1>tRophicPosition</h1>
<p><code>tRophicPosition</code>, is an R package incorporating a Bayesian model for the calculation of trophic position using stable isotopes with one or two baselines. As of 2017-05-14, the current version of the package is 0.6.8. <code>tRophicPosition</code> uses the powerful approach of Markov Chain Monte Carlo simulations provided by <a href="http://mcmc-jags.sourceforge.net">JAGS</a> and the statistical language <a href="https://www.r-project.org">R</a>. A vignette with basics of the model and a guide to the use of <code>tRophicPosition</code> can be found <a href="https://github.com/clquezada/tRophicPosition-release-and-vignettes/blob/master/A_guide_to_the_use_of_tRophicPosition_2016-06-12.pdf">here</a>. Other vignettes can be browsed with <code>browseVignettes(&quot;tRophicPosition&quot;)</code>.</p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In this vignette, we will introduce the new functions we have developed for <code>tRophicPosition</code> in its current version (0.6.8). These functions are <code>multiModelTP()</code>, <code>credibilityIntervals()</code>, <code>pairwiseComparisons()</code> and <code>parametricTP()</code>. Each of these functions accomplish different tasks within the Bayesian estimation of trophic position with stable isotopes, facilitating the calculation of multiple models (either one, two baselines and/or two baselines full model of trophic position) for a single species, pairwise comparisons of posterior estimates of trophic position and/or alpha parameters, plotting of credibility intervals of posterior estimates of trophic position and/or alpha, and calculation of a parametric (non-Bayesian) estimate of trophic position.</p>
<div id="installing-and-loading-the-package" class="section level2">
<h2>Installing and loading the package</h2>
<div id="stable-version---cran" class="section level3">
<h3>Stable version - CRAN</h3>
<p>Coming soon.</p>
</div>
<div id="development-version---github" class="section level3">
<h3>Development version - GitHub</h3>
<p>If you want to install the development version of <code>tRophicPosition</code>, you must install it from GitHub. For this, we use the function <code>install_github()</code> from the package <code>devtools</code> (installation instructions <a href="https://github.com/hadley/devtools#updating-to-the-latest-version-of-devtools">here</a>), which needs to be installed previously (either from <a href="https://CRAN.R-project.org/package=devtools">CRAN</a> or <a href="https://github.com/hadley/devtools">GitHub</a>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)
<span class="kw">library</span>(devtools)</code></pre></div>
<p>If you are working in Windows, <code>devtools</code> also requires <a href="http://bit.ly/2smGeVQ">Rtools</a>, or if you are working on a Mac, <a href="https://developer.apple.com/xcode/">Xcode</a> (from Apple Store). In Linux you will need to install a compiler and various development libraries.</p>
<p>Besides installing <code>devtools</code>, you must also install <a href="http://mcmc-jags.sourceforge.net/">JAGS</a> (Just Another Gibbs Sampler), which is at the core of the Bayesian model analysis supporting <code>tRophicPosition</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install_github</span>(<span class="st">&quot;clquezada/tRophicPosition&quot;</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>After installing <code>tRophicPosition</code>, it should be loaded into memory, which automatically reports the version of the software (we need at least 0.6.8-8 to use the routines described in this vignette).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tRophicPosition)</code></pre></div>
</div>
</div>
<div id="future-releases-and-how-to-get-support" class="section level2">
<h2>Future releases and how to get support</h2>
<p>You are encouraged to use <code>tRophicPosition</code> with your own data, test the package and see if there are any issues or problems. You can send your questions or commentaries to the google group <a href="https://groups.google.com/d/forum/trophicposition-support">tRophicPosition-support</a> or directly to the email <a href="mailto:trophicposition-support@googlegroups.com">trophicposition-support@googlegroups.com</a>. You can send your questions to <a href="http://stackexchange.com/" class="uri">http://stackexchange.com/</a> <a href="http://stackoverflow.com/" class="uri">http://stackoverflow.com/</a> or even <a href="https://www.facebook.com/groups/stableisotopes/">Facebook (stable isotope ecology group)</a>.</p>
<p>We are constantly working on future releases of <code>tRophicPosition</code>, so feedback is very much appreciated.</p>
</div>
</div>
<div id="calculation-of-tp-for-one-species-using-multiple-bayesian-models" class="section level1">
<h1>Calculation of TP for one species using multiple Bayesian models</h1>
<p>To demonstrate how <code>tRophicPosition</code> works, we will simulate some data. For example, imagine we have a fish species of interest that has mean (± SD) values of <span class="math inline">\(\delta^{15}\)</span>N of 6 (<span class="math inline">\(\pm\)</span> 1) ‰, and <span class="math inline">\(\delta^{13}\)</span>C of -4‰ (<span class="math inline">\(\pm\)</span> 1‰). Also, as in many aquatic ecosystems, this fish lives in a system with two sources of C and N, meaning that we have to deal with two different baselines. One of the baselines has mean (<span class="math inline">\(\pm\)</span>SD) values of <span class="math inline">\(\delta^{15}\)</span>N of -0.8 (<span class="math inline">\(\pm\)</span> 1) ‰ and <span class="math inline">\(\delta^{13}\)</span>C -10 (<span class="math inline">\(\pm\)</span> 1) ‰, the other baseline has mean values of 1.2‰ ( 1‰) and 2‰ ( 1‰) (<span class="math inline">\(\delta^{15}\)</span>N and <span class="math inline">\(\delta^{13}\)</span>C respectively). We will use the function generateTPData() to simulate this simple ecosystem.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">consumer1 &lt;-<span class="st"> </span><span class="kw">generateTPData</span>(<span class="dt">dCb1 =</span> -<span class="fl">17.3</span>, <span class="dt">dNb1 =</span> <span class="fl">14.2</span>,
                            <span class="dt">dCc =</span> -<span class="dv">15</span>, <span class="dt">dNc =</span> <span class="dv">21</span>,
                            <span class="dt">dCb2 =</span> -<span class="fl">12.7</span>, <span class="dt">dNb2 =</span> <span class="fl">15.4</span>,
                            <span class="dt">DeltaN =</span> <span class="fl">3.4</span>, <span class="dt">sd.DeltaN =</span> <span class="fl">0.98</span>,
                            <span class="dt">DeltaC =</span> <span class="fl">0.39</span>, <span class="dt">sd.DeltaC =</span> <span class="fl">1.3</span>,
                            <span class="dt">consumer =</span> <span class="st">&quot;Consumer 1&quot;</span>)</code></pre></div>
<p>In this function we have also indicated mean and sd values for trophic discrimination factors for <code>DeltaN</code> (<span class="math inline">\(\Delta\)</span>N) and <code>DeltaC</code> (<span class="math inline">\(\Delta\)</span>C), and also have indicated a name for the consumer. Remember that all the functions have a help page where you will find other options (write for example <code>?generateTPData</code> in the console).</p>
<p>Now that we have our simple ecosystem simulated, we will plot it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(consumer1)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAABF1BMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrYAujgzMzM6AAA6ADo6AGY6OmY6OpA6kJA6kNtEpcRKpkhLslVMz3NNTU1NTW5NTY5NbqtNjshao8xbq9VhnP9mAABmADpmAGZmOgBmOjpmOpBmZgBmZmZmZrZmkJBmtrZmtttmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OkdOOyP+PneGQOgCQOjqQOmaQZgCQkGaQkLaQkNuQtpCQuv+Q27aQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2Zjq2kDq225C2///Ijk3I///bkDrbkGbbkJDb///kq27k///r6+v4dm36n5n/tmb/yI7/25D/5Kv//7b//8j//9v//+T///9gk6SjAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO3diWMcxZUG8IGwGhyWmIQxJoxDNns6EJsgm2w2y8qAlF3bSnzqtPr//zu2q++juruuV/2q6vsSkDSa0uvR/Hhd1TPd2mQIwjibtTcAQeYCoAjrACjCOgCKsA6AIqwDoAjrACjCOgCKsA6AIqwDoAjrACjCOgCKsA6AIqwDoAjrACjCOgCKsA6AIqwDoAjrACjCOgCKsE7IQLdF1t4KhDTBAN2O82kR1kj3ddbekGATANAeR3lYGi1gfl8FSA3DH+g8zdbo2ts5TGPz+w7StTcqvHAHqshTNNG1N7WbTu8cGF17y0ILb6DKPHn10AmdIGoQ5kA1fPJpojM8QVQ3nIFq9U8+TXSuf4KobhgD1ebJA+giTxDVCV+gBj4ZCF1unyCqFbZAjXyuLlSVJ4SqJjagKwvVAAqiSuEK1NTnukC1fIKoSpgCNfa5qlBdnxC6nPiAKgh98+aN0la8aaNyd32fgqjSlqQbnkBtfC4IFdrevn27yK66Xx0FokY+0UQXwhKonc8ZoH10BdOp+/XvqEDU0Cea6Hw4ArX0OQd0qK5spf37SHCqEDUHCqEziRHolNBpeN3I77NI1MIndvMzYQjU2ueE0Fl6ipkUauUTTXQ6yQCdb40aRKXbbOsTTXQqcQKVCHXkc6KJ2gNFD5WHH1AXPsdCnfl8K2uiDnxCqDzsgLrxOQTq0ucYqBOfECpNrED7Qp36HAl15BPzUFm4AXXlswfUsc/hPNQZUDTRcVIA6tzn234TBVDCMAPqzGdXKAXQjlCHPiF0FF5AHfpsgZL4bIE69Qmhw8QLtBZK47MV6hgohPYTPVAqn7VQ1z6xlu8nYqClUDqghVD3Pr9HE+2GFVC3PguhhD4LoQBKnMiBkvrMhZL4hNBOOAF17TMXSuvz7VsioBDaBEBZAoXQOoyAuvdJDnT/6FsIpQ0foAQ+f/krWqH7R4+CF6p6CvZaiRnoL3/lASiZUC9AJWf9n202mw9eGP/Ei4+eWm9VN2yAkvikFVr4JBO6EtDT93NgJ8ZCzzbvAygzoAELHV845eo3R/m/3z2+n13dE9YuPv7PzeZ+0VfFVx8V/7z77s+bze38pttZfbd//G0B8+S9/0YH1fFJKbT2GeZO/s0oxc1nTe88uS2+uLhVfLj68ml2etAAfZx/eqv8Mr+b+Mat+9Uw7OL1fNIJbXwGKlRk3EHPDqpPBMm8nVYky8badtCjTPyT3yq+kd+1ZRkrUKoG6gVo8ELbGy4+rjqogJYjrEjmLXLz3pEM6L18TfXeUfRAiWaghEK7PsMVOgLazEH7HVR8S+zwx0C/LL4HoOY+iYT2gYa7UBoeB21W8dUctCQppqZiKprzze/QAdq5W5k4gZL69AI0XKHD1MdBq+V51UFPilV8drrZ/OLLHtD8btW+vwyAavskATr0GZFQXmEBlLaBhg00daEcgBL7pBA69gmhNIkR6NAngVAZUAilCAOg5A3UPVCpTwilSBpAHQud8ImFEkEiBCrx6VjoJFAIdZ71gXrx6VTotE/s5J0nOqATPj0BhVDXWR2opwbqCyiEOs7aQH35dCh01ieEOs7KQP35dCd0ASgWSk6zLlCfPl0BXfIJoU6TEFBHQpeBBiV0u13x75crJCWgToQq+AxI6LZMe8PFrc2mOBmu+nL45rneDSf3s6nk93PzxrtVgXr26UKoks9whI6BClXVGUjZ0rs754E62cBVgXr36Q9oIEK326HQAlbnrOPydCRx4nF+w8/+qTgFpHyPcp6Tfym+U92hPDO5HSj+X520XN5mlBWB+vdpL1TVJ5VQd1df3o5S3FwAvfj5UX06cXlCZ3V+8VlxdpzgW56dfFKc61HdoTozuR0o/l+etFzdZpTVgG7X8GktVB1oED1U0kGLOej9rH86cf6Z8Fee5dnuvcUuvtzNizuU84J2YHXXinB1dp121gO6ik9boRpAQxLa3lDr655OXJyPJM5HroDWZyZnfz2qkJaXHSnOTG4HdoCWtxlt4UpAnfdPZaBWQnV80gl1SHQaaHM68dW9+/UeXNJBxQnK5R3EDdU1SLJ6FV8DNeyeIqsAdc9TA6iFUD2fudAAmujgOGijrzmduEBWTkrbOWh5t5N6rinuUJ2Z3BvYnBN6u3NNHb34B7ql4Knh00KoLlD+S6VRGqDt6cSnm83Pflss6//hu9EqXnxS3eGkWcWXAztAmxH6oQc6XCwS6NTzaQxU3yfdO0dWed3T9TnvKqEFSgbSxmcu1IiogU+6vbz3V+bfPTZe51iFEKgnnPo+DZuoEdDYmqj3UAH1p9PEp0kTNfRJ2URTIEoE1CNPM6DaPdTYJ+HfWUiBKAlQvzyNfGr3UAugdD1UEI3cKAFQrzzN2qcBURugpESF0YiRugcajE8tonY+H1Hu5+NG6hyoV56WPoVQNaLWPqmFVkjjY+oYqN/2ae1TtYs68Em7mx8wdfukrhq3QP3yNF4f6RJ14tMb0biQOgXq26cTniXROaOufD7ysJ/vKXX53K4Vh0A9794d+iyMegHqrYlGY9Qd0DB37x2hU13UpU/fRJcP5XNH7Aqo7/bpuH/OGHXs85HX/fz3C210P1z616d89NO+TTnY045D758NUXqfvpvoXBsdA61Pmutlgls4px2HPf0cEN1S+yyI+m6j0udtvx8KLU87/u6o98eOxef/99E/i84a5GnH3nkS+iyNUvssjHoVOiK6H6W4ueygH79o/opxcwJH81lwpx17n30S++wQ3RMCXWFHP2qjkg5azEHLP3pYnXbcO3sjxNOOPb94RM+zIUrJsyS6tlH5HLQ4VbM57XgENLTTjkN4b50JUdL2yYSoHGiurvNXjGc7aAinHXt867w/nr/a73/9608++SQ+o+Me2v2yuXhY748d94AGd9qxtzOPPPIsfP46SqLzx+Wb46DtaceFyXwVXwMN7rRjP+dtrsHTq1FfSHm/cDRKEEB96+zwrI3SI/VlFEBd2/Q78xzp9I2UWimAOpTp0Wa1npXr7CCld/ptFQAVcQB0/JoEwjn2z7jPrP2HvBBkNgCKsA6AIqwDoAjrACjCOgCKsA6AIqwDoAjruAD6IRJQHDzhPuMEqN7dX5vUMBqEUuNBALqYUJ7KOEsB6GJCeSrjLFU/Wfs3bYy2wlMANLFSDdD23H/WQgE0sVISoKyJAmhipaRAc6JGW+IhAJpYqQmgbJsogCZWagqoIMrRKIAmVmoaKE+jAEpRSvWJ5gaU4WQUQAlKKR9cZAiUWxcFUPel1A9/cwTKzKgi0Mvf73aHzYc8L3e73WfPy28CaBYX0NIoD6RqQK+/Oc4uvzquPohbnh223wXQLDqgJVKjzXMbNaDnn2fCZPUh/9fND8ftdwE0i2gOyqyPqs9BRftsPlw/3FU7e/EWw9dIP/nzuvYmTEULKAOkykBvnjzofBA7+qaLooMGVEobaI10JaWqQK8fPuh8KFPPQwE0oFJGQFdUqryKP+x8qAKgAZYyB1orNdpm46gBHfk8v/squ/kRh5nCK2UJ1HsnVQMqjnrmi6Lqw+XXz8Utd+qFPIAGVMoeqF+lSb6SNP+7BVAtpcRMUwS68GsFUF2mRo9CMQkCXXqhB0D1idJ1UgB1Usrw+YkEaIep0QOaC4DqlpINNX1uogLaKnXJNEGgdnNQ2WDj08vjA9owNXpkkqQI1GYVL7UIoFKjTpQmCdRiEIB6Vho5UO3fzxI1uUXMQReUGj3OInEDNYIzP0D+I7GKX0Rq9FAjB2q26124/8QPDGXisg7Qt8aNFEDHo0zqAKgiUt3tThXozK9Kf04gAqDKRrV+wVEDnZ6DznVW7Y5rfnA6QaAlUvXtjhtofxXffjFrSrJEny0CoAZElbc7cqDdLzqMdIAu6gNQE6Gqv68YgbZaXvdvbRxpAFXghzmoEVG17Y4QaAfU68GtNECxijcCqiY0PqBdUa+Ht9IA1dtA20GRAFVsoakBHd9n/AMkP8/lBtoOigQoOmgmAdr7cuoHjH+g0w20HRQHUNVVUnxA5+agvS8nx+tu27AU8aAogGIVPxqlfCQIQD34VN7uGIFajgJQcp54JclmFIDy4QmgkgAoqU7NX29CQFV/NwBK6FN7u9MBqvyCOYBS6TR5w4IToGtfNVgl1YFQlXuSb8uaWQuo4dtp0umg6u85Qgel4Gn0SDMAHcfnO+fSAGraPIskA1RxDprf5U3m7RT3JIDanRifCtA3iq3xTf1/pXTuB6ATPHHhBqVRGi9z1v8o3n1USiPRA7W/+k0yQGmy8qMyGOQTqIuLMyUDVG1ArQ4d1IVPo0c3SCpAFVMBxSLJhU8AdT5KsuumKmU+KBCgji4RCqDddHlqMmX8qHqD/F0f1OixjQKg3XSA6jZSxo+qN8gbUKOHNg6A9tL32b0SifNSxoMAVDcRAc2kQFW6KetHlQGoRrg/lSOgSgsn7o8KQJXD/ansqMzaTwEUQJ0PsjrlozcDBVAAJRikMEoCb/yrxRwUQEkGjUcNocnoSX61WMXrA8VxUINRQ4/SnTfeUe9GqNFjGyUpoCOPAAqg40QCdDAOQAHUetTYo+IcVJLhSAAFUPtRY49Kq3hJ8IZlALUftLyKlwVAAVQ//g/UL9wJQAHUehAhUMxB/fgE0HGwinfhE0DJRuE4qAugRo9MEgAdZfRmEbpS0QJ15lMV6OXvd7vDLLt+uLv7qrih/SxSoL23g1KVihSos/17pgr0+pvj7PKr45snh9nLz8UN7WdZnEDbVbrKW5lMS8UJ1CFPVaDnwuKzw+s/Ps8uv36ef95+lkUOVOnNoKalogTq1KfGHDTvopd/eFU003yX33z2YZ61L8rqMCXH5nq3bzQufBtGiIFqztwdAr158iA7v1uzbD/Louug5aA3/VCW8jLKSwd1rTNTB3r98EG3b7afZZECzaZ9Sr0G8qgIgTpvnkWUV/H5Gj5LYw5aD6ptSnxKnopQHhURUBqdmSrQ0mexm69X8Q+iXcUPgQ4ycXMoj4oGKJHOTBXoy53IYXX0U7TOiI+DNoPkrRJARzqpuqcIXkmaGST9zQPoACehziwWoFO/JRI1mIN2dBo9AJ1EAXTyQBCNGqziK55GW6+ZGIBOH6oMRY3HUm6Aku/ZmwCom0HBlLIH6g+nCIC6GRRMKUugXnGKxADU9xzU3ajQgPrWmUUC1O8q3uGokID63bM3iQMoSikPMgK6Ek4RAE2slD7Q9XCKAGhipfSArtg6qwBoYqW0gK6MUwRAEyulDHT95lkEQBMrpQaUB04RAE2slApQNjozAE2ulAJQRjwBNLlSS0D57NzLAGhipeaBMtOZAWhypeaA8uMJoMmVmgVqtDm0AdDESk0D5dg/ATS5UpNAWfIE0ORKTQFl6hNAUys1AZSrTwBNrRSALiaUpzLOUnKgbH0CaGqlkgS69kVZEfVIgfL1iQ6aWikAXUwoT2WcpYIHeropclvjZwBoQKXCBnp1r5Z5unnvSPVnAGhApYIGevXl04kvZgOgiqNG77VkApSxT8xBPZYaX6EHQBcDoN5KSa5xBqCLkQB99zhfJN3X+BkAqjQKQE0iAXp6oDMBzQBUcRSAmkQGNF/IX3wEoM5H8ZqDtkJ5vlO5CnbxHkuxWsXvg2igWCSlVioCoOigMZcaA2XtE4uk1Eo1QB/twwN6dU80TiySYi41Asrb57CDnmzeO8IuPuZSHaD7AIEWM9APXuj9DAANqFQLtGyhzH0OgJ7lvfODFxe3tN5tB6AhleoALYQGBfTqN0flFDQ7fR9z0DhL9YDu2fuUvN3uRKt7igBoQKW6QHOhYQGtdvG6PwNAAyrVA5oLNdoCj8ErSYmV6gH99vuwgOId9fGXGgBlL3R0TlJ1ABTnJEVaqgs095kL5U10tIs/wVmdUZfqAP22AMpcKOagiZXqAv2+CmehAJpYKRlQzkIBNLFSLdDWJ+fdPIAmVkoOlC9RAE2s1BRQrvt5ZaCXXz/PXu5EDsWX4tPPnpffAtCASjVAhz6ZNtHBG5Y3dYZvFjmvOZ7ffSU+PDtsvwegAZWaAcqSqLyDngyPgz6789PXBdDrb47Fh5sfjttvAmhApWaBMiQqA3p1T/Iq0mUJ9OXnxVfXD+t9/Yd51r5qMKKeBaCCKCujEqBn0jc0lUCrBppdfnXcdlF00IBKNUA/mQDKbLk0BnqyOZDdsQRazUDL1PNQAA2olApQTjv6IdB3jyfOlyuBPnvQuQlA1UfJd5xcgTIiOgB6cWvqXI8CaLNXF5305kccZlIdtd9Lha4KdF4ol7loH+ipfPcuUgAtp6DVIdE79UIeQJdG7fdyoWsC/WIBKJO5qOpx0LkA6NKoQIFy6KJ4qdNHKZZAVYSuPxkFUC+lGM5Bc6BKQlduow3Qq9+9yPfwOnv2JgC6PIrfKv4LxRZaGDXaTifpAv3rkfi3/s8AUJtS+g3KGVANoat10QHQd38yaKEAalFqYudPUapID6i60NUmoy3Qewd/Qwf1Xmpq+URQqkwfqI7QddpoZ5F0tjkoLs6kHQA1L7U2UC2ha0xGsYpft9TqQHWF+u6iALpyqXXnoIVQPaKejXbmoNqvINUBUJtSa67izYR6Ndp20IuPDdZHRQB0eRTL46AWRL0Z7eziT3WuS98NgC6OYvlKUo+otlBPKybMQX2U4vla/BeWTdRLFwVQH6UCAGpGlN6oBKhYLuGPKDgdFQRQs/08tdEB0NP3n17du139JQXVAOjiKPo56BITFaCGQklno4ML2P5rlp0Ua6W/4w3LTkdRr+IXD6cqATXbzZN20QHQv2Rnv/iL+AxAgyq1/IKUGlBzolRGR38K8YMXfzvKsrPJc5MkAdDVS7kDakGUxOjEn+PW+ls0ALp6KZdAzaei3xO8KQ+HmeIo5WgOat1EnRMF0EhKOVnFOxHqdk8PoL5LdffGzI6DOtrNOzUKoGuUqp89xkAthTo7Nsod6Ha71R9kVspqkN5+1xPQbnl9oNZCnRBlDnS7rYTyBppL0Fq5+AHaK68N1F6oE6JOgJJdbXVbxnCo662ZTCFh4mbZN17LbnMeeXl1oNY7eSdEeXfQCqjeoHakpw46dRBy+uCklw7aL6/fQZ0ItSYaKdC69eqNKgOgLoHaLpZ4AzWeg+oDrVdjDoEazUEVDtB4moM6AmrZQ5kDNV3FawNt/kswaWvTELVX8YuvCElHTW/XaJB/oHZCuQM1HaQ5B23nEi5X8dP3rz6OBi2/pi4bpZIVgVoJjRVo2Xo9AVVpe/0B1cdEgNrMQ6MFqjfKCqiSqv6I6iOALgZAy9jMQR0CdTsHlQ1aB6i5UACtQrGKnx4xXcrhKl46aBWgFi0UQO0HaftcOg6q+NZOrWAXr5zYgOo30AWgSz8OQDUDoE6BLv48f0CdHWcy2eIyAGo9KF6gzo7Um2xwFQC1H1S+aUhrxFwpRkBdvdhpssFVANTBIMHJ4Tvq2cxBHQmN+rV4q0FsSwWyii+Ervy2ZQBdo1QI5yS5Imr5hlAAXaOUMdCit3oGuu5p8gC6QqlmF250wMA/UKvL4ZhsbCcAaj9Ip62VxPL/7Q1KVev7FYAKokZGIz8nyXKQx+Og+SiV56JaoO+rvfxyqd4PXROomdHYT5qzHOSlVKNG4bmoD3GKu+6VSnECWhrV++OJJpvaC4DaDmqBkmRca405aB+pvx08gNoPknTQsaz+fU076FqreNM+yubCDXp3jwzouK3Jel/vvhpzUBcb2BvkAmiNdEmpi2vfAKj9oGFbmwFqt4o33cDuIFdAFVqpk4szAaj7UnNA6zs4KqU/yCnQEillAw0MaOfUNupSNqMWfAb2UqcCUXkjTRBoHg2e6zXrBZ+RAW2Urgr08uvnWfZyt9t99lx8ef1wd/fV4DErJgGgS4kQqASpV6DnBcxnh9WXN08Os5efDx6zYgA0VqADpD6BPrvzU95Bb344rr6+/uPzsqd2H7NiADRmoCXSlXbx+X59tyua6OUfXmXX3wiuH+ZxfOXV2WvPbpfuEEK8XMBWHh9Aqz7qH+jlV8dVFz2/WwPNnHdQ6Uq920HVl/KcO6jxi5b8O2iFdK+1t5uI3iJJpJiHth00cwt0u932jiWNLpi0zbbqB5sYA61eHyUvNRzkD+gX+0+1jgnKYwiUag66HQAdX8A2LKBTr3ianKu8UEpxkFegeWyJagEVO/abHwXLmycPtFfxCleP2w6ASi4BzhSoHNsUwoSA2hLVPg5657heL2keB1W5mre0gQ6BcpyDyrVNKkwKqB1Rb68kSaxN3qk7A5UAzVR9egM6wW0GaBpz0E/tifICOmqOzSjex0HngUq+kSWwiu/4FESNHio7oKPmWA973UxLdbZsZaCTQiM/UC8DairU35tFVOagE6O223Y0S6DTqyG50BSBGgr1+G4mhVW8dFB/ac8T6PT7l5IFOvRpKJT92+06DZQz0MlRqQId+4wUaNl4wwUq3fvHD3QvAWoklD/QMsznoHOjJlbxFKUUBvkBKvUZNVDeq3jdUSOgWsfs2QOV8zQTGgzQ+pMwgQ4ADoHqvarEHegUT5ZAJS/6JAi0C7C7ano9volqA70BnWyfLIHKXjZPD+gkwDFQFaecgc7xZAhU+sYjq9+v8svw9qXcjVIHqtRJ+QKd52n0kjwR0HrJ7RioOCKaTTxKGd1AgGY9n3z+VqeuzgWeRi2UBmhz0FIR6PJ2v67vt524t6SQxt+LH5dyOmqK3XAVHzBQBZ18gHYOq6vNQRWBbjv/TJbs/lQuQKemlq8H3wkVqErz5AlUcRW/pQkfoJODBiBDnIMq6zQSSg1UkhQ76NSgUcsMbRWvpZMN0PmTMmwWSVpzUDaLpOlBmkdAbUpVH50C1dTJB+js0SBPq/ggdvEBA93rNk8zoaG91Dknv5eio7IHqvkip1WpMm6AmuFMAajqK0nz02C1UvSjhqt42lJF7IEats4aqOZzAqDTpeYzkMW/WZexBWqD06SFRgS055Ec6HDfnAJQu96ZOtABSOI56Gh1Q1VKMgVYB6gLnPEBbcwtAh21TNpVvC+gskWUf6BOWmeMQFtz+kA1S2kO8gRUehjKL1CXOGMD2kE3CbRG6Rmopzno6kDd4tT36QYo1dWAK3T925pvtXcZfOYnuRsvRfZuC+kAddw71wOqd3cXHbS+vds3Q3ypc/Ee681BKXTyealzLg7moI3LhaNJ4QNdZxXvet7Z8GTydrv5OFjFJwTUdSkVoCQ4C6D6280c6HjQ4FSS+cPxoajxWGoRKFHz/NTwIqFhAu24nH25KBQ1HkvNA6XTaXoN20CBKr6rKRQ1HkvNACXVacaTKdC59XiI58VzKjUNlExnGNeob7P4+5XNK6eBDu7b+zIUNR5LTQElnHla8GQJdP41IckrSaP3iCiXMto+h6PYAKXiaakzCx/o4M6DL0NR47GUDCjVQU/7vzMHoAbb53AUD6BcjslLwxCo1hwUQDUHjYBStE8nvbMMR6Baq3jMQfUGDYG69jn/yol+WAKdHCTb+fdv6H8/FDUeSw2Aun2rp1ubRcICKkmf7BZAFwb1gDpsnxQ4RUIH2p90DtdXoajxWKoP1B1Po0eiEH5A5f8lAqijUl2gTny6nnQOwg7oxOMFUEelOkDtd/C0NotwAyo9CDo3CHNQvUEtUDufxI2zSfBAx6t41VJTSQaoFU+jLTdI+ECNSzkdFEwpe6CeWmcVbkB156A2pVwOCqZUA9TIp1+cIuyAaq7irUo5HBRMKXOg/nGK8APqcBBKjQeZAl0DpwiAJlbKBOg6vbMMgCZWqgEaAE4RAE2slBbQlXGKAGhipTSArq8zA9DkSqkCZdA8iygDvfz6ef6v3+92h8WXL3e73WfPy28BaECllIBy0ZmpAz0XHK+/Oc4uvzoWXz87bL8HoAGVUgDKR2emDPTZnZ/yDnr+eVbRvPnhuP1mWEAXu0PaQBk1zyJ6u/g8oovm/364q3b2H+ZxeH1V8hQvpa69EStmASgvnZk+0JsnD4qv8h1900VD6qBTb0YhKEU1iLCDMuueIppArx8+aG+q56EAajqKF1CGPPVX8Z21EYBaj+IElCVPTaCtz/O7r7KbH0M8zLT8TvA0gfLkqQlUHPzM10bVp3fqhXxQQLGKL7MPoX1meCUpuVIyoHx5AmhypSRAOfsE0NRKjYFy5gmgyZUaAeXtE0BTK9UA3SoccWMQAE2slOaTtXoANLFSALqYUJ7KOEsB6GJCeSrjLAWgiwnlqYyzVJJAkYDi4An3GRdAfcTj7xWlOAVAUYp1QgGKJBoARVgHQBHWAVCEdQAUYR32QDunmogvu5fcoSjVKXD9cHf3FU2luQsJkZRqHwvlo6IId6Dn9RN3Xv5au5fcISnVFLh5cpi9/Jyw1MSFhChKtY+F8lGRhDnQ8pI7WX1Bk/4ldyhKtQWu//i8uZwKSamJCwlRlGofC+GjoglzoM0VTar/6ttL7hCVagtc/uFV/Z8FTSmR4YWEiEq1j4X0UVEkEKD177R3yR2KUm0BMaegBiq7kBBFqfaxkD4qivAF+my3E12zfCrPuxN75zO2Xqm6AE2v6ZWSXkiIohQ6KF3Kp/JZ55kkW1L0gZLO1mYuJERRCnNQuhS/zWb/17vkDkWptoDY/ZKtd2cuJERRqn0spI+KImEArXZPg0vukJQqC1TrJdLjoBMXEqIoVT0W6kdFEfZAkbQDoAjrACjCOgCKsA6AIqwDoAjrACjCOgCKsA6AIqwDoEWuvnyaZSebzf21NwQZBEBFzjbvP83ODkqnCKcAaJ53//XuT4VMAGUXAC1SAj3Z3F57Q5BBALRI1UGzUyH0dLPZvHfUfOvx/at7udx331U3Xf3mSPYjEJKkDTSXJ2afJdCz2wXQd48/eCGQ1uul04P8/xc/P7r4+EV1y9kHLyZ+HuI8aQP9+9PcqGiaRQfNV/EH+b9LfqeVQuZ47MoAAAE4SURBVNEvT25f3bt/2qzw8566zuammLSBtl2xSU6x97WAKoD+x5/a9RNaqL+kDTS7uDW0lu/Mu1++eyx2/Pku/s8Hk/dBCJM20Ksvnw6xXXzUO9JUNNR8qnpw8u9ipXRWrJ6GXRahS9JAi8OeZ+/3RA7A1havfve/eRv9n3wqelC1VcRLkgZ6Jnbbg3bYiCwPJtVfnt4WE9F/+/mRmH8CqL8kDbRYqQ8Pa1bL99OysVZA33131AGKXby/JA304lbeCU8O+jcOjoOeFM0yX+6ftrt4LJL8JWmgudCN5NXNk+4rSeUhpZypWClVi6RTHGbylrSBKkTywiYO1HsMgC7l9GB4C47TewyALmXUL/FmEZ8BUIR1ABRhHQBFWAdAEdYBUIR1ABRhHQBFWAdAEdYBUIR1ABRhnf8HZNtozLI5fHgAAAAASUVORK5CYII=" /><!-- --></p>
<p>In this figure we can see that sample of simulated fish consumers is exactly located in-between both baselines on the <span class="math inline">\(\delta^{13}\)</span>C axis, and also, our fish is 6.8‰ above the baseline 1 in terms of its <span class="math inline">\(\delta^{15}\)</span>N value. If we use a one baseline model, and if the trophic level of baseline 1 (<code>lambda</code>) is 2, we would expect a mean trophic position of 4 for our simulated fish species. If we use a two baselines model without fractionation for carbon, we would expect an <code>alpha</code> value of 0.5, which means that each baseline is contributing in 50% of the energy inputs to our fish. Finally, if we use a two baselines full model (including fractionation for <span class="math inline">\(\delta^{13}\)</span>C), the trophic position of our fish would depend on both baselines, and the relative contribution of each baseline would depend on the trophic discrimination factors (<span class="math inline">\(\Delta\)</span>N and <span class="math inline">\(\Delta\)</span>C). Clearly, this is worth exploring more, so we will calculate (and compare) estimates for TP using these models with the function <code>multiModelTP()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">consumer1_models &lt;-<span class="st"> </span><span class="kw">multiModelTP</span>(consumer1)</code></pre></div>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 106
##    Unobserved stochastic nodes: 6
##    Total graph size: 134
## 
## Initializing model
## 
## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 206
##    Unobserved stochastic nodes: 14
##    Total graph size: 297
## 
## Initializing model
## 
## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 313
##    Unobserved stochastic nodes: 16
##    Total graph size: 413
## 
## Initializing model</code></pre>
<p><code>multiModelsTP()</code> requires an object of the class <code>isotopeData</code>, which was created previously by the function <code>generateTPData()</code>. By default <code>multiModelsTP()</code> defines a <code>lambda = 2</code> for the baselines, uses 2 chains (<code>n.chains = 2</code>) to do the Bayesian calculation with 20,000 adaptive iterations (<code>n.adapt = 20000</code>), 20,000 actual iterations (<code>n.iter = 20000</code>), 20,000 iterations as burnin (<code>burnin = 20000</code>) and a thinning of 10 (<code>thin = 10</code>). Furthermore, it estimates TP using three different Bayesian models: one baseline, two baselines and two baselines full (<code>models = c(&quot;oneBaseline&quot;, &quot;twoBaselines&quot;, &quot;twoBaselinesFull&quot;</code>). The default setting is to limit the amount of output for each model run (print = FALSE). NB: The user can change any of these options, simply adding them as arguments to <code>multiModelTP()</code>, see <code>?multiModelTP()</code> for details.</p>
<p>Also, by default this function uses Post’s (2002) assumptions on TDF (i.e. 56 values with mean 3.4 <span class="math inline">\(\pm\)</span> 0.98 SD for <span class="math inline">\(\Delta\)</span>N and 107 values with mean 0.39 <span class="math inline">\(\pm\)</span> 1.3 SD for <span class="math inline">\(\Delta\)</span>C).</p>
<p>For example, if we have used the option <code>print = TRUE</code> as argument (i.e. <code>multiModelTP(print = TRUE)</code>), we would have a trace plot for every model (to check graphically if our parameters of interest <code>TP</code>, <code>muDeltaN</code> and <code>alpha</code> have converged), and if more than 1 chain were used, also would have printed two statistics from the coda package: Gelman and Rubin’s convergence diagnostic statistics (see ?gelman.diag for a detailed explanation). Basically, we expect that potential scale reduction factors for each parameter is close to 1, which means that our model has converged and it is reliable.</p>
<p>These estimates have been generated using Post’s (2002) mean estimates for TDFs, which are commonly used across a wide range of ecological studies. Now that we have calculated the trophic position for our simulated fish in a simple ecosystem, we will do the same calculation, but this time, we will change the trophic discrimination factor from Post’s (2002) values to McCutchan’s et al. (2003) values in order to examine the sensitivity of the models to TDF estimates. To do this, we will we will generate <code>consumer2</code> with the same isotope values as <code>consumer1</code> and simply change the variables <code>deltaN</code> and <code>deltaC</code> within the object <code>consumer2</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">consumer2 &lt;-<span class="st"> </span><span class="kw">generateTPData</span>(<span class="dt">dCb1 =</span> -<span class="fl">17.3</span>, <span class="dt">dNb1 =</span> <span class="fl">14.2</span>,
                            <span class="dt">dCc =</span> -<span class="dv">15</span>, <span class="dt">dNc =</span> <span class="dv">21</span>,
                            <span class="dt">dCb2 =</span> -<span class="fl">12.7</span>, <span class="dt">dNb2 =</span> <span class="fl">15.4</span>,
                            <span class="dt">consumer =</span> <span class="st">&quot;Consumer 2&quot;</span>)

consumer2$deltaN &lt;-<span class="st"> </span><span class="kw">TDF</span>(<span class="dt">author =</span> <span class="st">&quot;McCutchan&quot;</span>, <span class="dt">element =</span> <span class="st">&quot;N&quot;</span>)</code></pre></div>
<pre><code>## You selected McCutchan's et al (2003)
##                   All d15N: 73 values with 2.3 mean +- 0.18 se</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">consumer2$deltaC &lt;-<span class="st"> </span><span class="kw">TDF</span>(<span class="dt">author =</span> <span class="st">&quot;McCutchan&quot;</span>, <span class="dt">element =</span> <span class="st">&quot;C&quot;</span>)</code></pre></div>
<pre><code>## You selected McCutchan's et al (2003)
##                   All d13C: 102 values with 0.5 mean +- 0.13 se</code></pre>
<p>And now we will calculate the three Bayesian models of trophic position again, with the only difference being we have changed their TDF values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">consumer2_models &lt;-<span class="st"> </span><span class="kw">multiModelTP</span>(consumer2)</code></pre></div>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 123
##    Unobserved stochastic nodes: 6
##    Total graph size: 151
## 
## Initializing model
## 
## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 223
##    Unobserved stochastic nodes: 14
##    Total graph size: 314
## 
## Initializing model
## 
## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 325
##    Unobserved stochastic nodes: 16
##    Total graph size: 425
## 
## Initializing model</code></pre>
<p>In both cases we have calculated three Bayesian models (one baseline, two baselines without fractionation for C, and two baselines full model with C fractionation) for two simulated simple ecosystems consisting of one fish and 2 baselines, and the only difference between consumer 1 and consumer 2 is the trophic discrimination factor. In the first case we included Post’s (2002) values, and in the second case we included McCutchan’s et al. (2003) values for both N and C. We have saved the output of <code>multiModelTP()</code> into two objects <code>consumer1_models</code> and <code>consumer2_models</code>, and now we will analyze the results.</p>
<p>If you are using RStudio, in the environment tab you will see that both <code>consumer1_models</code> and <code>consumer2_models</code> are lists of 4 elements each. The first element is a data frame named TP. This dataframe has the posterior samples of TP for each model. The second element is also a data frame, named alpha in this case, which includes the posterior samples of alpha for 2 over the 3 models (only the two baselines models calculate alpha, i.e. the relative contribution of the baseline 1). The third element is a data frame as well, named gg (to indicate us that has the structure required to use the ggplot2 package). This data frame has summary values of both posterior samples of trophic position and alpha: median and 95% credibility interval, grouped by model, community and species. The fourth and last element is a list of 3 elements named samples, that has raw posterior mcmc samples if you want to summarise the information, or analyze it in a different way. The first three elements (data frames TP, alpha and gg) are based in these raw posterior samples of every Bayesian model, summarised by <code>multiModelsTP()</code> for convenience.</p>
<p>WWe can produce a detailed summary of the structure described above using the function <code>str()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(consumer1_models)</code></pre></div>
<p>In order to plot the mode and 95% credibility interval for both posterior trophic position and alpha, we can use the function <code>credibilityIntervals():</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># For consumer 1 (based on Post's (2002) TDF values)</span>
<span class="kw">credibilityIntervals</span>(consumer1_models$gg, <span class="dt">x =</span> <span class="st">&quot;model&quot;</span>)</code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_pointrange).</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This figure provides mode (<span class="math inline">\(\pm\)</span> 95% credibility interval) for posterior estimates trophic position from the three different models (one baseline two baselines and two baselines full), as well as alpha (only given for two baselines models).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># For consumer 2 (based on McCutchan's (2003) TDF values)</span>
<span class="kw">credibilityIntervals</span>(consumer2_models$gg, <span class="dt">x =</span> <span class="st">&quot;model&quot;</span>)</code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_pointrange).</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The arguments <code>df = consumer1_models$gg</code> and <code>x = model</code> above, tells the function <code>credibilityIntervals()</code> to plot the data frame <code>consumer1_models$gg</code> using the model column within that data frame as the independent variable (<code>x</code>), and by default using the mode as the central tendency descriptor (see <code>credibilityIntervals()</code> for details). If you want to plot the median instead of the mode add <code>y1 = &quot;median</code> and <code>y2 = &quot;alpha.median&quot;</code> as arguments within <code>credibilityIntervals()</code>. When we have multiple species or several communities we will change this (e.g. see the vignette multiple species calculation of trophic position).</p>
<div id="why-we-need-of-accurate-trophic-discrimination-factors-tdf" class="section level2">
<h2>Why we need of accurate trophic discrimination factors (TDF)?</h2>
<p>Probably, the single and most important assumption to get accurate and reliable estimations of trophic position is the <em>trophic discrimination factor</em>, either for nitrogen <span class="math inline">\(\Delta^{15}\)</span>N (one and two baselines models) and both <span class="math inline">\(\Delta\)</span>N and <span class="math inline">\(\Delta\)</span>C for the two baselines full model. Obviously, the use of a non-representative TDF estimate for either <span class="math inline">\(\Delta\)</span>N or <span class="math inline">\(\Delta\)</span>C can affect both trophic position estimations and the alpha parameter.</p>
<p>Now we will examine the impact of using the different TDFs for our simulated consumers. We have estimated trophic position and alpha for both consumers groups (differing only in TDF) and will test for statistical differences between posterior samples of these parameters. First, we must change the names of both posterior samples, because they have the same name (as they were calculated with <code>multiModelsTP()</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Here we see that we have 4000 posterior samples of 3 parameters (one for each Bayesian model) for consumer1</span>
<span class="kw">str</span>(consumer1_models$TP)</code></pre></div>
<pre><code>## List of 3
##  $ 1b : num [1:4002] 4.13 3.98 4.03 3.67 4.04 ...
##  $ 2b : num [1:4002] 3.84 3.75 3.9 3.89 3.89 ...
##  $ 2bf: num [1:4002] 4.01 3.83 4.02 3.92 3.73 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># And also 4000 posterior samples (for each 3 Bayesian models) for consumer2</span>
<span class="kw">str</span>(consumer2_models$TP)</code></pre></div>
<pre><code>## List of 3
##  $ 1b : num [1:4002] 5.18 5.26 5.59 5.2 4.81 ...
##  $ 2b : num [1:4002] 4.88 4.9 4.85 4.85 4.75 ...
##  $ 2bf: num [1:4002] 4.26 4.52 4.73 4.64 4.74 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># But the names of each variables are the same for both consumers</span>
<span class="co"># For consumer1</span>
<span class="kw">names</span>(consumer1_models$TP)</code></pre></div>
<pre><code>## [1] &quot;1b&quot;  &quot;2b&quot;  &quot;2bf&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># For consumer2</span>
<span class="kw">names</span>(consumer2_models$TP)</code></pre></div>
<pre><code>## [1] &quot;1b&quot;  &quot;2b&quot;  &quot;2bf&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># So, we change them in order to compare them.</span>
<span class="co"># To make things clear, consumer 1 will be &quot;Post&quot; and consumer 2 will be &quot;McCutchan&quot;. </span>
<span class="co"># Also, one baseline Bayesian model will be model1, two baselines model will be model2</span>
<span class="co"># and two baselines full model will be model2F</span>
<span class="kw">names</span>(consumer1_models$TP) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Post-model1&quot;</span>, <span class="st">&quot;Post-model2&quot;</span>, <span class="st">&quot;Post-model2F&quot;</span>)
<span class="kw">names</span>(consumer2_models$TP) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;McCutchan-model1&quot;</span>, <span class="st">&quot;McCutchan-model2&quot;</span>, <span class="st">&quot;McCutchan-model2F&quot;</span>)</code></pre></div>
<p>A useful first step is to summarize the posterior distributions to get a quantitative idea of how different they are. For this, we will use the base function (i.e. that comes with R) <code>sapply()</code>. This function is part of the <code>lapply</code> functions that apply a function (in this case <code>summary</code>) over a list. As we have two lists (<code>consumer1_models$TP</code> and <code>consumer2_models$TP</code>) first we need to use the <code>c</code> operator, that combines them, then we will calculate a summary for the combined element:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Here we combine posterior estimates of trophic position for both consumers</span>
combined_models &lt;-<span class="st"> </span><span class="kw">c</span>(consumer1_models$TP, consumer2_models$TP)

<span class="co"># Then we calculate a summary of posterior trophic position</span>
<span class="kw">sapply</span>(combined_models, summary)</code></pre></div>
<pre><code>##         Post-model1 Post-model2 Post-model2F McCutchan-model1
## Min.       3.601470    3.454768     3.503555         4.205249
## 1st Qu.    3.923471    3.754408     3.808278         4.810021
## Median     4.002741    3.824696     3.883405         4.969726
## Mean       4.007452    3.828636     3.888297         4.991311
## 3rd Qu.    4.088773    3.899703     3.965246         5.147033
## Max.       4.404429    4.199431     4.387981         6.214655
##         McCutchan-model2 McCutchan-model2F
## Min.            3.893367          3.970993
## 1st Qu.         4.380203          4.479410
## Median          4.519625          4.627032
## Mean            4.532303          4.654922
## 3rd Qu.         4.665636          4.805767
## Max.            5.677488          5.913503</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># And we calculate the modes</span>
<span class="kw">getPosteriorMode</span>(combined_models)</code></pre></div>
<pre><code>##       Post-model1       Post-model2      Post-model2F  McCutchan-model1 
##             3.996             3.801             3.878             4.939 
##  McCutchan-model2 McCutchan-model2F 
##             4.504             4.573</code></pre>
<p>Here we have a rudimentary summaries of posterior trophic position estimates associated with each model for both consumers. For example, the median TP for consumer 1 based on the one baseline model (Post-model1) is higher than consumer 1 calculated with both 2 baselines (Post-model2) and 2 baselines full (Post-model2F) models. It appears that the same is true for consumer 2, where median TP estimated for the one baseline model (McCutchan-model1) is higher than that for both two baselines model (McCutchan-model2 and McCutchan-model2F).</p>
<p>As we are operating in a Bayesian universe, there is little sense to state a threshold under or above which both distributions will be considered different (as used in a frequentist universe e.g. p &gt; 0.05). Instead, we think rather of comparing posterior distributions. For example, we can say that two posterior trophic position estimates will be considered different if their samples of posterior distributions are 100% different. In this stringent case and considering Post-model1 and McCutchan-model1 posterior estimates of trophic position, we would expect then that all the posterior estimates of Post-model1 are lesser than posterior estimates of McCutchan-model1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">compareTwoDistributions</span>(combined_models$<span class="st">&quot;Post-model1&quot;</span>, combined_models$<span class="st">&quot;McCutchan-model1&quot;</span>, <span class="dt">test =</span> <span class="st">&quot;&lt;=&quot;</span>)</code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Above, we can see that trophic position posterior estimate of one baseline model using Post’s (2002) TDF assumptions has a proportion of 4000 observations over the 4000 we sampled (i.e. 4000 / 4000 = 1) that are lesser or equal than trophic position posterior estimate of the same one baseline model but using McCutchan’s (2003) TDF assumptions. Thus, we are pretty confident that posterior estimation of trophic position calculated with one baseline Bayesian model with Post’s (2000) assumptions is higher than posterior estimation of trophic position calculated with McCutchan’s TDF assumptions. Remember that this is the same simulated fish consumer, in the same simple ecosystem, only considering differents TDF assumptions.</p>
<p>By default <code>compareTwoDistributions()</code> evaluates how many observations from <code>combined_models$&quot;Post-model1&quot;</code> are <span class="math inline">\(\leq\)</span> (less than or equal) than <code>combined_models$&quot;McCutchan-model1&quot;</code>, randomly drawn from each of the models posterior distribution. We can change to <span class="math inline">\(\geq\)</span>, <span class="math inline">\(&lt;\)</span> or <span class="math inline">\(&gt;\)</span> stating the argument within <code>pairwiseComparisons</code> function (add <code>test = &quot;&gt;=&quot;</code>, for example).</p>
<p>We can make a more detailed comparison of the different models and TDFs using the <code>pairwiseComparisons</code>() function, which as its name suggests, produces a matrix of of pairwise comparisons:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairwiseComparisons</span>(combined_models, <span class="dt">test =</span> <span class="st">&quot;&lt;=&quot;</span>)</code></pre></div>
<pre><code>##                         [1]   [2]   [3]   [4]   [5]   [6]
## [1] Post-model1       0.000 0.137 0.238 1.000 0.988 0.997
## [2] Post-model2       0.863 0.000 0.647 1.000 1.000 1.000
## [3] Post-model2F      0.762 0.353 0.000 1.000 0.998 1.000
## [4] McCutchan-model1  0.000 0.000 0.000 0.000 0.086 0.174
## [5] McCutchan-model2  0.012 0.000 0.002 0.914 0.000 0.642
## [6] McCutchan-model2F 0.003 0.000 0.000 0.826 0.358 0.000</code></pre>
<p>The matrix generated by this function is symmetrical, below the diagonal we have the results of comparing how many posterior samples of the model in row are less or equal than posterior samples of the model in the column, while above the diagonal we have the results of comparing how many posterior samples of the model in the column are higher than posterior samples of the model in the row.</p>
</div>
</div>
<div id="parametric-trophic-position" class="section level1">
<h1>Parametric trophic position</h1>
<p>As an appendix, we will calculate the parametric (i.e. non-Bayesian) version of trophic position. For this, we have to iterate through each consumer, and do the calculation with <code>parametricTP()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First we  combine both consumers isotope values into a named list</span>
consumers &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;consumer1&quot;</span> =<span class="st"> </span>consumer1, <span class="st">&quot;consumer2&quot;</span> =<span class="st"> </span>consumer2)

<span class="co"># And then, we calculate parametric TP using a loop for</span>
for (consumer in consumers) <span class="kw">parametricTP</span>(consumer)</code></pre></div>
<pre><code>## [1] &quot;***************************************&quot;
## [1] &quot;Parametric version of trophic position&quot;
## [1] &quot;For consumer:  Consumer 1&quot;
## [1] &quot;One baseline TP:  4&quot;
## [1] &quot;Two baselines TP:  3.82 0.5&quot;
## [1] &quot;Full model TP. At the beginning:  3.82 0.662&quot;
## [1] &quot;Convergence after  8  iterations. TP:  3.88  alpha:  0.665&quot;
## [1] &quot;***************************************&quot;
## [1] &quot;Parametric version of trophic position&quot;
## [1] &quot;For consumer:  Consumer 2&quot;
## [1] &quot;One baseline TP:  4.96&quot;
## [1] &quot;Two baselines TP:  4.7 0.5&quot;
## [1] &quot;Full model TP. At the beginning:  4.7 0.755&quot;
## [1] &quot;Convergence after  10  iterations. TP:  4.83  alpha:  0.763&quot;</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
